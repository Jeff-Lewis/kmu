<p id="notice"><%= notice %></p>
<div class="container-fluid">
	<div class="row">
    <div class="col-md-12">
      <div class="panel panel-info">
        <div class="panel-heading">
          <%= form_tag users_path, :method => "get" do %>
            <div class="row">
              <div class="col-md-4">
                <%= text_field_tag :search, params[:search], class:"form-control" %>
              </div>
              <div class="col-md-1">
                <%= submit_tag "Suche", :name => nil, class:"btn btn-primary btn-lg" %>
              </div>
              <div class="col-md-1">
                <%= link_to "Suche (erweitert)", new_search_path, class:"btn btn-default btn-lg" %>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>
	<div class="row">
    <div class="col-md-6">
      <div class="panel panel-default">
    		<!--<table class="table table-striped table-hover-->
    		<table class="table">
          <thead>
            <tr>
              <th></th>
              <th colspan="2">Privatperson</th>
              <th>Email</th>
              <th colspan="3"></th>
            </tr>
          </thead>
        
          <tbody>
            <% @users.each do |u| %>
              <tr>
                <td>
                <% if u.services.where("free=?",true).count > 0 %>
                  <%= image_tag("helpinghand.png", :size => "50x50" , class:"img-rounded") %>
                <% end %>
                </td>
                <td>
                <% if !u.avatar_file_name %>
                  <%= image_tag("p_anonym.png", :size => "50x50" , class:"img-rounded") %>
                <% else %>
                  <%= image_tag u.avatar(:small), class:"img-rounded" %>
                <% end %>
                </td>
                <td><%= u.name + " " + u.lastname %></td>
                <td><%= u.email %></td>
                <td>
                  <ul class="nav nav-pills">
                    <li>
        				        <%= link_to services_path(:mode => "private", :user_id => u.id) do %>
                          <i class="btn btn-default glyphicon glyphicon-info-sign"></i><span class="badge pull-right"><%= u.services.where("user_id=?", u.id).count %></span>
                        <% end %>
        				    </li>
        				    <!--<li>-->
        				    <!--    <%= link_to u do %>-->
                <!--          <i class="btn btn-info glyphicon glyphicon-info-sign"></i>-->
                <!--        <% end %>-->
        				    <!--</li>-->
        	          <li>
        				        <%= link_to edit_user_path(u) do %>
                          <i class="btn btn-default glyphicon glyphicon-wrench"></i>
                        <% end %>
        				    </li>
            	      <li>
        				        <%= link_to u, method: :delete, data: { confirm: 'Are you sure?' } do %>
                          <i class="btn btn-danger glyphicon glyphicon-trash"></i>
                        <% end %>
        				    </li>
        			    </ul>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
  
    <div class="col-md-6">
      <div id="map">
      </div>
    </div>

  </div>
</div>

<script>
    handler = Gmaps.build('Google');
    handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
      markers = handler.addMarkers(<%=raw @hash.to_json %>);
      handler.bounds.extendWith(markers);
      handler.fitMapToBounds();
});
</script>