<div class="container-fluid">
	<div class="row">
    <div class="col-md-12">
      <div class="panel-heading header">
        <h1>
        VERANSTALTUNGEN
        <span class="badge"><%= @eveanz %></span>
        <%= link_to events_path(:page => session[:page], :dir => "<")  do %>
          <i class="btn btn-primary btn-lg glyphicon glyphicon-chevron-left"></i>
        <% end %>
        KW <%= session[:cw].to_s + " / " + session[:year].to_s %>
        <%= link_to events_path(:page => session[:page], :dir => ">")  do %>
          <i class="btn btn-primary btn-lg glyphicon glyphicon-chevron-right"></i>
        <% end %>
        </h1>
      </div>
    </div>
  </div>
	<div class="row">
    <div class="col-md-12">
  		<table class="table table-striped">
        <thead>
          <tr>
            <td colspan="12">
              <div class="digg_pagination">
                  <%= will_paginate @events, :container => false, previous_label: "<", next_label: ">" %>
              </div>	  
            </td>
          </tr>
          <tr>
            <th colspan="2">Veranstaltung</th>
            <% for i in 0..6 %>
              <th>
                <%= $wochentage[i] %><br>
                <%= (@start+i).strftime("%d-%m-%y") %>
              </th>
            <% end %>
          </tr>
        </thead>
        
        <tbody>

            <% @events.each do |e| %>

              <tr>
    				    <td>
    				    <%= link_to e do %>
                  <% if !e.avatar_file_name %>
                    <%= image_tag("event_a.png", :size => "50x50" , class:"img-rounded") %>
                  <% else %>
                    <%= image_tag e.avatar(:small), class:"img-rounded" %>
                  <% end %>
                <% end %>
                </td>
                <td>
                    <%= link_to e do %>
              	      <div class="anzeigetext">
                        <%= e.name %></br>
                      </div>
                      <% if e.company_id != nil %>
                        <%= e.company.name %>
                      <% end %>
                      <% if e.user_id != nil %>
                        <%= e.user.name + " " + e.user.lastname %>
                      <% end %>
                      <%= e.date_from.strftime("%d.%m") %>-<%= e.date_to.strftime("%d.%m") %>
                    <% end %>
        				</td>
                <% for i in 0..6 %>
                    <% if EventDatum(@start+i,e) %>
                      <td class="blocked">
                    <% else %>
                      <td class="free">
                    <% end %>
                    </th>
                <% end %>

              </tr>

            <% end %>

        </tbody>
      </table>
    </div>
  </div>
  
	<div class="row">
    <div class="col-md-12">
      <div id="map">
      </div>
    </div>
  </div>
    
</div>

<script>
    handler = Gmaps.build('Google');
    handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
      markers = handler.addMarkers(<%=raw @hash.to_json %>);
      handler.bounds.extendWith(markers);
      handler.fitMapToBounds();
});
</script>